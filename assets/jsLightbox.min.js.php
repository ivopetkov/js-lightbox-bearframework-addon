<?php

/*
 * JS lightbox for Bear Framework
 * https://github.com/ivopetkov/js-lightbox-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.jsLightbox=ivoPetkov.bearFrameworkAddons.jsLightbox||function(){var e=null,t=null,n=null,l=null,i=null,o=0,r="",s=null;clientPackages.get("escapeKey").then((function(e){s=e}));var u=!1,c=[],a=null,d=function(t){if(null!==e&&a!==t)if(a=t,t){if(e.setAttribute("class","ipjslghtbc ipjslghtbcv"),null!==e.parentNode)for(var n=e.parentNode.childNodes,l=0;l<n.length;l++){var i=n[l];i!==e&&void 0!==i.setAttribute&&(i.setAttribute("inert","true"),c.push(i))}}else{e.setAttribute("class","ipjslghtbc");for(l=0;l<c.length;l++)try{c[l].removeAttribute("inert")}catch(e){}}},v=null,f=function(){if(null!==v)return v;var e=document.body,t=document.createElement("p");t.style.width="100%",t.style.height="200px";var n=document.createElement("div");n.style.position="absolute",n.style.top="-10000px",n.style.left="-10000px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),e.appendChild(n);var l=t.offsetWidth;n.style.overflow="scroll";var i=t.offsetWidth;return l===i&&(i=n.clientWidth),e.removeChild(n),v=l-i},h=function(c,a){var v=null!==t;window.clearTimeout(t),t=null,void 0===a&&(a={});var h=void 0!==a.spacing?a.spacing:"15px",m=void 0===a.showCloseButton||a.showCloseButton,g=void 0!==a.onOpen?a.onOpen:null,y=void 0===a.closeOnEscKey||a.closeOnEscKey,w=void 0!==a.onBeforeEscKeyClose?a.onBeforeEscKeyClose:null,C=void 0!==a.resolveBeforeHTMLAdded&&a.resolveBeforeHTMLAdded,A=!1;if(null===e){var j=document.body;e=document.createElement("div"),d(!1),e.setAttribute("data-lightbox-component","container"),e.innerHTML="<div><div><div></div></div></div>",e.innerHTML+='<a class="ipjslghtbx" role="button" tabindex="0" data-lightbox-component="close-button" aria-label="'+r+'" title="'+r+'"></a>',e.lastChild.addEventListener("click",p),j.appendChild(e),n=window.setTimeout((function(){d(!0),n=null,function(){if(!u){var e=document.body;e.style.overflow="hidden",e.scrollHeight>window.innerHeight&&(e.style.marginRight=f()+"px"),u=!0}}()}),16),A=!0}else d(!0);v&&(A=!0),A&&s.addHandler(b),e.lbCloseOnEscKey=y,e.lbOnBeforeEscKeyClose=w,e.lastChild.style.display=m?"block":"none";var k=e.firstChild.firstChild.firstChild;return k.setAttribute("data-lightbox-component","content"),new Promise((function(e,t){if('<span class="ipjslghtbcl"></span>'===c){null===(n=k.querySelector(".ipjslghtbcl"))?(k.style.padding=h,k.innerHTML=c,l=window.setTimeout((function(){var e=document.querySelector(".ipjslghtbcl");null!==e&&e.setAttribute("class","ipjslghtbcl ipjslghtbclv")}),1e3)):n.setAttribute("class","ipjslghtbcl ipjslghtbclv"),e()}else{var n,r=function(){var n;n=o,clientPackages.get("html5DOMDocument").then((function(i){n===o?(window.clearTimeout(l),l=null,k.style.padding=h,i.insert(c,[k]),null!==g&&g(k),C||e()):t()})).catch((function(){t()}))};null===(n=k.querySelector(".ipjslghtbcl"))?r():(n.setAttribute("class","ipjslghtbcl"),i=window.setTimeout(r,300)),C&&e()}}))},p=function(o){if(o&&null!==e){if(!1===e.lbCloseOnEscKey)return!1;if(null!==e.lbOnBeforeEscKeyClose)if(!1===e.lbOnBeforeEscKeyClose())return!1}if(window.clearTimeout(n),n=null,window.clearTimeout(l),l=null,window.clearTimeout(i),i=null,null!==e)return d(!1),null===t&&(t=window.setTimeout((function(){e.parentNode.removeChild(e),e=null,a=null,function(){if(u){var e=document.body;e.style.overflow="auto",e.style.marginRight="auto",u=!1}}(),t=null}),300),s.removeHandler(b)),!0},b=function(){return p(!0)};return Promise=window.Promise||function(e){var t=[],n=null;this.then=function(e){return t.push(e),this},this.catch=function(e){return null===n&&(n=e),this};var l=function(){for(var e in t)t[e].apply(null,arguments)},i=function(){null!==n&&n.apply(null,arguments)};window.setTimeout((function(){e(l,i)}),16)},{make:function(t){return o++,h('<span class="ipjslghtbcl"></span>',t),n=o,{isActive:function(){if(n===o&&null!==e){var t=e.getAttribute("class");return null===t&&(t=""),-1!==t.indexOf("ipjslghtbc")}return!1},open:function(e,t){return n===o?h(e,t):new Promise((function(e,t){t()}))},close:function(){n===o&&p(!1)}};var n},close:function(){p(!1)},initialize:function(e){return r=e[0],this}}}();
EOT;
