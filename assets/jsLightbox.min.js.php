<?php

/*
 * JS lightbox for Bear Framework
 * https://github.com/ivopetkov/js-lightbox-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.jsLightbox=ivoPetkov.bearFrameworkAddons.jsLightbox||function(){var e=null,t=null,n=null,l=null,i=null,o=0,s="",r=null;clientPackages.get("escapeKey").then((function(e){r=e}));var u=!1,c=null,a=function(){if(null!==c)return c;var e=document.body,t=document.createElement("p");t.style.width="100%",t.style.height="200px";var n=document.createElement("div");n.style.position="absolute",n.style.top="-10000px",n.style.left="-10000px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),e.appendChild(n);var l=t.offsetWidth;n.style.overflow="scroll";var i=t.offsetWidth;return l===i&&(i=n.clientWidth),e.removeChild(n),c=l-i},d=function(c,d){var f=null!==t;window.clearTimeout(t),t=null,void 0===d&&(d={});var p=void 0!==d.spacing?d.spacing:"15px",b=void 0===d.showCloseButton||d.showCloseButton,g=void 0!==d.onOpen?d.onOpen:null,m=void 0===d.closeOnEscKey||d.closeOnEscKey,w=void 0!==d.onBeforeEscKeyClose?d.onBeforeEscKeyClose:null,y=void 0!==d.resolveBeforeHTMLAdded&&d.resolveBeforeHTMLAdded,j=!1;if(null===e){var C=document.body;(e=document.createElement("div")).setAttribute("class","ipjslghtbc"),e.setAttribute("data-lightbox-component","container"),e.innerHTML="<div><div><div></div></div></div>",e.innerHTML+='<a class="ipjslghtbx" role="button" tabindex="0" data-lightbox-component="close-button" aria-label="'+s+'" title="'+s+'"></a>',e.lastChild.addEventListener("click",v),C.appendChild(e),n=window.setTimeout((function(){e.setAttribute("class","ipjslghtbc ipjslghtbcv"),n=null,function(){if(!u){var e=document.body;e.style.overflow="hidden",e.scrollHeight>window.innerHeight&&(e.style.marginRight=a()+"px"),u=!0}}()}),16),j=!0}else e.setAttribute("class","ipjslghtbc ipjslghtbcv");f&&(j=!0),j&&r.addHandler(h),e.lbCloseOnEscKey=m,e.lbOnBeforeEscKeyClose=w,e.lastChild.style.display=b?"block":"none";var A=e.firstChild.firstChild.firstChild;return A.setAttribute("data-lightbox-component","content"),new Promise((function(e,t){if('<span class="ipjslghtbcl"></span>'===c){null===(n=A.querySelector(".ipjslghtbcl"))?(A.style.padding=p,A.innerHTML=c,l=window.setTimeout((function(){var e=document.querySelector(".ipjslghtbcl");null!==e&&e.setAttribute("class","ipjslghtbcl ipjslghtbclv")}),1e3)):n.setAttribute("class","ipjslghtbcl ipjslghtbclv"),e()}else{var n,s=function(){var n;n=o,clientPackages.get("html5DOMDocument").then((function(i){n===o?(window.clearTimeout(l),l=null,A.style.padding=p,i.insert(c,[A]),null!==g&&g(A),y||e()):t()})).catch((function(){t()}))};null===(n=A.querySelector(".ipjslghtbcl"))?s():(n.setAttribute("class","ipjslghtbcl"),i=window.setTimeout(s,300)),y&&e()}}))},v=function(o){if(o&&null!==e){if(!1===e.lbCloseOnEscKey)return!1;if(null!==e.lbOnBeforeEscKeyClose)if(!1===e.lbOnBeforeEscKeyClose())return!1}if(window.clearTimeout(n),n=null,window.clearTimeout(l),l=null,window.clearTimeout(i),i=null,null!==e)return e.setAttribute("class","ipjslghtbc"),null===t&&(t=window.setTimeout((function(){e.parentNode.removeChild(e),e=null,function(){if(u){var e=document.body;e.style.overflow="auto",e.style.marginRight="auto",u=!1}}(),t=null}),300),r.removeHandler(h)),!0},h=function(){return v(!0)};return Promise=window.Promise||function(e){var t=[],n=null;this.then=function(e){return t.push(e),this},this.catch=function(e){return null===n&&(n=e),this};var l=function(){for(var e in t)t[e].apply(null,arguments)},i=function(){null!==n&&n.apply(null,arguments)};window.setTimeout((function(){e(l,i)}),16)},{make:function(t){return o++,d('<span class="ipjslghtbcl"></span>',t),n=o,{isActive:function(){if(n===o&&null!==e){var t=e.getAttribute("class");return null===t&&(t=""),-1!==t.indexOf("ipjslghtbc")}return!1},open:function(e,t){return n===o?d(e,t):new Promise((function(e,t){t()}))},close:function(){n===o&&v(!1)}};var n},close:function(){v(!1)},initialize:function(e){return s=e[0],this}}}();
EOT;
