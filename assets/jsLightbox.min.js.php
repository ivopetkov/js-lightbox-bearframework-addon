<?php

/*
 * JS lightbox for Bear Framework
 * https://github.com/ivopetkov/js-lightbox-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.jsLightbox=ivoPetkov.bearFrameworkAddons.jsLightbox||function(){var t=null,e=null,n=null,l=null,i=0,o="",s=null;clientPackages.get("escapeKey").then((function(t){s=t}));var r=!1,u=null,c=function(){if(null!==u)return u;var t=document.body,e=document.createElement("p");e.style.width="100%",e.style.height="200px";var n=document.createElement("div");n.style.position="absolute",n.style.top="-10000px",n.style.left="-10000px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(e),t.appendChild(n);var l=e.offsetWidth;n.style.overflow="scroll";var i=e.offsetWidth;return l===i&&(i=n.clientWidth),t.removeChild(n),u=l-i},a=function(u,a){window.clearTimeout(e),e=null,void 0===a&&(a={});var v=void 0!==a.spacing?a.spacing:"15px",f=void 0===a.showCloseButton||a.showCloseButton,p=void 0!==a.onOpen?a.onOpen:null,b=void 0!==a.onBeforeEscKeyClose?a.onBeforeEscKeyClose:null;if(null===t){var m=document.body;(t=document.createElement("div")).setAttribute("class","ipjslghtbc"),t.setAttribute("data-lightbox-component","container"),t.innerHTML="<div><div><div></div></div></div>",t.innerHTML+='<a class="ipjslghtbx" role="button" tabindex="0" data-lightbox-component="close-button" aria-label="'+o+'" title="'+o+'"></a>',t.lastChild.addEventListener("click",d),m.appendChild(t),s.addHandler(h),n=window.setTimeout((function(){t.setAttribute("class","ipjslghtbc ipjslghtbcv"),n=null,function(){if(!r){var t=document.body;t.style.overflow="hidden",t.scrollHeight>window.innerHeight&&(t.style.marginRight=c()+"px"),r=!0}}()}),16)}else t.setAttribute("class","ipjslghtbc ipjslghtbcv");t.onBeforeEscKeyClose=b,t.lastChild.style.display=f?"block":"none";var g=t.firstChild.firstChild.firstChild;return g.setAttribute("data-lightbox-component","content"),new Promise((function(t,e){if('<span class="ipjslghtbcl"></span>'===u)null===g.querySelector(".ipjslghtbcl")&&(g.style.padding=v,g.innerHTML=u,l=window.setTimeout((function(){var t=document.querySelector(".ipjslghtbcl");null!==t&&t.setAttribute("class","ipjslghtbcl ipjslghtbclv")}),1e3));else{var n=function(){var n;n=i,clientPackages.get("html5DOMDocument").then((function(o){n===i?(window.clearTimeout(l),l=null,g.style.padding=v,o.insert(u,[g]),null!==p&&p(g),t()):e()})).catch((function(){e()}))},o=g.querySelector(".ipjslghtbcl");null===o?n():(o.setAttribute("class","ipjslghtbcl"),window.setTimeout(n,300))}}))},d=function(i){if(i&&null!==t.onBeforeEscKeyClose&&!1===t.onBeforeEscKeyClose())return!1;if(window.clearTimeout(n),n=null,window.clearTimeout(l),l=null,null!==t)return t.setAttribute("class","ipjslghtbc"),null===e&&(e=window.setTimeout((function(){t.parentNode.removeChild(t),t=null,function(){if(r){var t=document.body;t.style.overflow="auto",t.style.marginRight="auto",r=!1}}(),e=null}),300)),s.removeHandler(h),!0},h=function(){return d(!0)};return Promise=window.Promise||function(t){var e=[],n=null;this.then=function(t){return e.push(t),this},this.catch=function(t){return null===n&&(n=t),this};var l=function(){for(var t in e)e[t].apply(null,arguments)},i=function(){null!==n&&n.apply(null,arguments)};window.setTimeout((function(){t(l,i)}),16)},{make:function(e){return i++,a('<span class="ipjslghtbcl"></span>',e),n=i,{isActive:function(){if(n===i&&null!==t){var e=t.getAttribute("class");return null===e&&(e=""),-1!==e.indexOf("ipjslghtbc")}return!1},open:function(t,e){return n===i?a(t,e):new Promise((function(t,e){e()}))},close:function(){n===i&&d(!1)}};var n},close:function(){d(!1)},initialize:function(t){return o=t[0],this}}}();
EOT;
