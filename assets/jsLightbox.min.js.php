<?php

/*
 * JS lightbox for Bear Framework
 * https://github.com/ivopetkov/js-lightbox-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.jsLightbox=ivoPetkov.bearFrameworkAddons.jsLightbox||function(){var t=null,e=null,n=null,i=null,o=0,l="",s=!1,r=null,c=function(){if(null!==r)return r;var t=document.body,e=document.createElement("p");e.style.width="100%",e.style.height="200px";var n=document.createElement("div");n.style.position="absolute",n.style.top="-10000px",n.style.left="-10000px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(e),t.appendChild(n);var i=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return i===o&&(o=n.clientWidth),t.removeChild(n),r=i-o},u=function(r,u){window.clearTimeout(e),void 0===u&&(u={});var h=void 0!==u.spacing?u.spacing:"15px",v=void 0===u.showCloseButton||u.showCloseButton,f=void 0!==u.onOpen?u.onOpen:null,p=void 0!==u.onBeforeEscKeyClose?u.onBeforeEscKeyClose:null;if(null===t){var b=document.body;(t=document.createElement("div")).setAttribute("class","ipjslghtbc"),t.setAttribute("data-lightbox-component","container"),t.innerHTML="<div><div><div></div></div></div>",t.innerHTML+='<a class="ipjslghtbx" role="button" tabindex="0" data-lightbox-component="close-button" aria-label="'+l+'" title="'+l+'"></a>',t.lastChild.addEventListener("click",d),b.appendChild(t),b.addEventListener("keydown",a),n=window.setTimeout((function(){t.setAttribute("class","ipjslghtbc ipjslghtbcv"),n=null,function(){if(!s){var t=document.body;t.style.overflow="hidden",t.scrollHeight>window.innerHeight&&(t.style.marginRight=c()+"px"),s=!0}}()}),16)}else t.setAttribute("class","ipjslghtbc ipjslghtbcv");t.onBeforeEscKeyClose=p,t.lastChild.style.display=v?"block":"none";var m=t.firstChild.firstChild.firstChild;return m.setAttribute("data-lightbox-component","content"),new Promise((function(t,e){if('<span class="ipjslghtbcl"></span>'===r)null===m.querySelector(".ipjslghtbcl")&&(m.style.padding=h,m.innerHTML=r,i=window.setTimeout((function(){var t=document.querySelector(".ipjslghtbcl");null!==t&&t.setAttribute("class","ipjslghtbcl ipjslghtbclv")}),1e3));else{var n=function(){var n;n=o,clientPackages.get("html5DOMDocument").then((function(l){n===o?(window.clearTimeout(i),m.style.padding=h,l.insert(r,[m]),null!==f&&f(m),t()):e()})).catch((function(){e()}))},l=m.querySelector(".ipjslghtbcl");null===l?n():(l.setAttribute("class","ipjslghtbcl"),window.setTimeout(n,300))}}))},d=function(o){if((void 0===o&&(o=!1),o&&null!==t.onBeforeEscKeyClose)&&!1===t.onBeforeEscKeyClose())return;if(window.clearTimeout(n),window.clearTimeout(i),null!==t){try{document.body.removeEventListener("keydown",a)}catch(t){}t.setAttribute("class","ipjslghtbc"),e=window.setTimeout((function(){t.parentNode.removeChild(t),t=null,function(){if(s){var t=document.body;t.style.overflow="auto",t.style.marginRight="auto",s=!1}}()}),300)}},a=function(t){27===t.keyCode&&d(!0)};return Promise=window.Promise||function(t){var e=[],n=null;this.then=function(t){return e.push(t),this},this.catch=function(t){return null===n&&(n=t),this};var i=function(){for(var t in e)e[t].apply(null,arguments)},o=function(){null!==n&&n.apply(null,arguments)};window.setTimeout((function(){t(i,o)}),16)},{make:function(e){return o++,u('<span class="ipjslghtbcl"></span>',e),n=o,{isActive:function(){if(n===o&&null!==t){var e=t.getAttribute("class");return null===e&&(e=""),-1!==e.indexOf("ipjslghtbc")}return!1},open:function(t,e){return n===o?u(t,e):new Promise((function(t,e){e()}))},close:function(){n===o&&d()}};var n},close:d,initialize:function(t){return l=t[0],this}}}();
EOT;
